<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>192.168.0.110 cpu_rate 异常检测汇总图</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <style>
        .custom-tooltip {
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            max-width: 300px;
            font-size: 13px;
            line-height: 1.4;
        }
        .custom-tooltip-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .custom-tooltip-item {
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="chart_summary_c099d1e8" style="width:100%; height:600px;"></div>
    <script>
        // 存储tooltip数据（将从父窗口填充）
        let tooltipData = {"1": {"method": "Z-Score", "ts": 1742178000, "value": 2.0, "explanation": "Z-Score=3.71，高于均值3.71个标准差"}, "2": {"method": "Z-Score", "ts": 1742181600, "value": 2.06, "explanation": "Z-Score=3.86，高于均值3.86个标准差"}, "3": {"method": "Z-Score", "ts": 1742184600, "value": 2.0, "explanation": "Z-Score=3.71，高于均值3.71个标准差"}, "4": {"method": "Z-Score", "ts": 1742185200, "value": 2.11, "explanation": "Z-Score=3.98，高于均值3.98个标准差"}, "5": {"method": "Z-Score", "ts": 1742188800, "value": 1.97, "explanation": "Z-Score=3.64，高于均值3.64个标准差"}, "6": {"method": "Z-Score", "ts": 1742192400, "value": 2.06, "explanation": "Z-Score=3.86，高于均值3.86个标准差"}, "7": {"method": "Z-Score", "ts": 1742196000, "value": 2.02, "explanation": "Z-Score=3.76，高于均值3.76个标准差"}, "8": {"method": "Z-Score", "ts": 1742199600, "value": 1.97, "explanation": "Z-Score=3.64，高于均值3.64个标准差"}, "9": {"method": "Z-Score", "ts": 1742203200, "value": 2.02, "explanation": "Z-Score=3.76，高于均值3.76个标准差"}, "10": {"method": "Z-Score", "ts": 1742206800, "value": 1.95, "explanation": "Z-Score=3.59，高于均值3.59个标准差"}, "11": {"method": "Z-Score", "ts": 1742210400, "value": 2.04, "explanation": "Z-Score=3.81，高于均值3.81个标准差"}, "12": {"method": "Z-Score", "ts": 1742214000, "value": 2.1, "explanation": "Z-Score=3.96，高于均值3.96个标准差"}, "13": {"method": "Z-Score", "ts": 1742217600, "value": 2.1, "explanation": "Z-Score=3.96，高于均值3.96个标准差"}, "14": {"method": "Z-Score", "ts": 1742221200, "value": 2.09, "explanation": "Z-Score=3.93，高于均值3.93个标准差"}, "15": {"method": "Z-Score", "ts": 1742224800, "value": 1.96, "explanation": "Z-Score=3.61，高于均值3.61个标准差"}, "16": {"method": "CUSUM", "ts_start": 1742185200, "ts_end": 1742185500, "explanation": "CUSUM值=7.31，累计偏移超过阈值(6.0)"}, "17": {"method": "Hampel Filter", "ts": 1742214000, "value": 2.1, "explanation": "20:20:00: 值 2.10 高于局部中位数 (0.33) 119.38 个标准差"}, "18": {"method": "Hampel Filter", "ts": 1742181600, "value": 2.06, "explanation": "11:20:00: 值 2.06 高于局部中位数 (0.39) 112.64 个标准差"}, "19": {"method": "Hampel Filter", "ts": 1742181300, "value": 1.31, "explanation": "11:15:00: 值 1.31 高于局部中位数 (0.39) 62.05 个标准差"}, "20": {"method": "Hampel Filter", "ts": 1742221200, "value": 2.09, "explanation": "22:20:00: 值 2.09 高于局部中位数 (0.34) 59.02 个标准差"}, "21": {"method": "Hampel Filter", "ts": 1742210400, "value": 2.04, "explanation": "19:20:00: 值 2.04 高于局部中位数 (0.33) 57.67 个标准差"}, "22": {"method": "Hampel Filter", "ts": 1742192400, "value": 2.06, "explanation": "14:20:00: 值 2.06 高于局部中位数 (0.37) 56.99 个标准差"}, "23": {"method": "Hampel Filter", "ts": 1742206800, "value": 1.95, "explanation": "18:20:00: 值 1.95 高于局部中位数 (0.32) 54.97 个标准差"}, "24": {"method": "Hampel Filter", "ts": 1742224800, "value": 1.96, "explanation": "23:20:00: 值 1.96 高于局部中位数 (0.34) 54.63 个标准差"}, "25": {"method": "Hampel Filter", "ts": 1742184600, "value": 2.0, "explanation": "12:10:00: 值 2.00 高于局部中位数 (0.38) 54.63 个标准差"}, "26": {"method": "Hampel Filter", "ts": 1742199600, "value": 1.97, "explanation": "16:20:00: 值 1.97 高于局部中位数 (0.36) 54.30 个标准差"}, "27": {"method": "Hampel Filter", "ts": 1742178000, "value": 2.0, "explanation": "10:20:00: 值 2.00 高于局部中位数 (0.39) 54.30 个标准差"}, "28": {"method": "Hampel Filter", "ts": 1742188800, "value": 1.97, "explanation": "13:20:00: 值 1.97 高于局部中位数 (0.38) 53.62 个标准差"}, "29": {"method": "Hampel Filter", "ts": 1742217600, "value": 2.1, "explanation": "21:20:00: 值 2.10 高于局部中位数 (0.33) 39.79 个标准差"}, "30": {"method": "Hampel Filter", "ts": 1742185200, "value": 2.11, "explanation": "12:20:00: 值 2.11 高于局部中位数 (0.37) 39.12 个标准差"}};
        
        // 监听来自父窗口的消息以更新tooltip数据
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'tooltipData') {
                tooltipData = event.data.data;
                console.log('Received tooltip data:', tooltipData);
            }
        });
        
        // 创建自定义tooltip格式化器以显示异常详情
        function customTooltipFormatter(params) {
            // 默认tooltip用于常规点
            if (!params || !params.data) return '';
            
            // 检查这是否是标记点或区域（异常）
            let isAnomaly = false;
            let anomalyId = null;
            
            // 检查markPoint和markArea（检查组件类型）
            if (params.componentSubType === 'markPoint' || params.componentSubType === 'markArea') {
                isAnomaly = true;
                // 从标签或数据中提取异常ID
                if (params.data && params.data.label) {
                    const labelText = params.data.label.formatter;
                    anomalyId = parseInt(labelText.replace(/[^0-9]/g, ''));
                } else if (params.name && params.name.includes('#')) {
                    anomalyId = parseInt(params.name.replace(/[^0-9]/g, ''));
                } else if (params.data && params.data.id) {
                    const idText = params.data.id;
                    anomalyId = parseInt(idText.replace(/[^0-9]/g, ''));
                }
            }
            
            // 对于普通数据点（非异常），返回null使用默认tooltip
            if (!isAnomaly) {
                if (Array.isArray(params.value) && params.value.length >= 2) {
                    const date = new Date(params.value[0]);
                    const dateStr = date.toLocaleString();
                    return `<div class="custom-tooltip">
                        <div class="custom-tooltip-title">${dateStr}</div>
                        <div>${params.seriesName}: ${params.value[1].toFixed(2)}</div>
                    </div>`;
                }
                return null;
            }
            
            // 对于异常，创建自定义tooltip
            if (anomalyId && tooltipData[anomalyId]) {
                const anomalyInfo = tooltipData[anomalyId];
                let html = `<div class="custom-tooltip">`;
                html += `<div class="custom-tooltip-title">异常点 #${anomalyId}</div>`;
                
                // 根据可用数据格式化日期
                let dateStr = "";
                if (params.value && Array.isArray(params.value) && params.value.length >= 2) {
                    const date = new Date(params.value[0]);
                    dateStr = date.toLocaleString();
                } else if (anomalyInfo.ts) {
                    const date = new Date(anomalyInfo.ts * 1000);
                    dateStr = date.toLocaleString();
                }
                
                html += `<div>时间: ${dateStr}</div>`;
                html += `<div>检测方法: ${anomalyInfo.method}</div>`;
                
                if (anomalyInfo.ts_start && anomalyInfo.ts_end) {
                    // 是区间
                    const startDate = new Date(anomalyInfo.ts_start * 1000).toLocaleString();
                    const endDate = new Date(anomalyInfo.ts_end * 1000).toLocaleString();
                    html += `<div>异常区间: ${startDate} 至 ${endDate}</div>`;
                } else if (anomalyInfo.value !== undefined) {
                    html += `<div>数值: ${anomalyInfo.value.toFixed(2)}</div>`;
                }
                
                if (anomalyInfo.explanation) {
                    html += `<div class="custom-tooltip-item">说明: ${anomalyInfo.explanation}</div>`;
                }
                
                html += `</div>`;
                return html;
            }
            
            return null;
        }
        
        // 初始化图表
        var chart = echarts.init(document.getElementById('chart_summary_c099d1e8'));
        var option = {"title": {"text": "192.168.0.110 cpu_rate 异常检测汇总图", "left": "center"}, "tooltip": {"trigger": "item", "axisPointer": {"type": "cross"}, "formatter": null}, "legend": {"top": 30, "data": ["原始序列", "CUSUM 辅助曲线"]}, "grid": {"left": "3%", "right": "8%", "bottom": "10%", "containLabel": true}, "toolbox": {"feature": {"saveAsImage": {}, "dataZoom": {}, "restore": {}}}, "xAxis": {"type": "time", "name": "时间", "axisLabel": {"formatter": "{yyyy}-{MM}-{dd} {HH}:{mm}", "rotate": 30, "margin": 14}}, "yAxis": [{"type": "value", "name": "数值", "position": "left"}, {"type": "value", "name": "辅助曲线值", "position": "right", "splitLine": {"show": false}}], "series": [{"name": "原始序列", "type": "line", "data": [[1742140800000, 0.34], [1742141100000, 0.33], [1742141400000, 0.34], [1742141700000, 0.33], [1742142000000, 0.36], [1742142300000, 0.26], [1742142600000, 0.33], [1742142900000, 0.26], [1742143200000, 0.33], [1742143500000, 0.25], [1742143800000, 0.34], [1742144100000, 0.31], [1742144400000, 0.32], [1742144700000, 0.29], [1742145000000, 0.31], [1742145300000, 1.28], [1742145600000, 0.34], [1742145900000, 0.37], [1742146200000, 0.31], [1742146500000, 0.3], [1742146800000, 0.37], [1742147100000, 0.3], [1742147400000, 0.33], [1742147700000, 0.3], [1742148000000, 0.34], [1742148300000, 0.31], [1742148600000, 0.32], [1742148900000, 0.32], [1742149200000, 0.33], [1742149500000, 0.3], [1742149800000, 0.33], [1742150100000, 0.31], [1742150400000, 0.32], [1742150700000, 0.3], [1742151000000, 0.29], [1742151300000, 0.31], [1742151600000, 0.28], [1742151900000, 0.38], [1742152200000, 0.29], [1742152500000, 0.34], [1742152800000, 0.29], [1742153100000, 0.34], [1742153400000, 0.26], [1742153700000, 0.33], [1742154000000, 0.39], [1742154300000, 0.28], [1742154600000, 0.34], [1742154900000, 0.27], [1742155200000, 0.34], [1742155500000, 0.28], [1742155800000, 0.36], [1742156100000, 0.29], [1742156400000, 0.31], [1742156700000, 0.32], [1742157000000, 0.34], [1742157300000, 0.32], [1742157600000, 0.4], [1742157900000, 0.32], [1742158200000, 0.26], [1742158500000, 0.32], [1742158800000, 0.36], [1742159100000, 0.26], [1742159400000, 0.32], [1742159700000, 0.31], [1742160000000, 0.35], [1742160300000, 0.29], [1742160600000, 0.3], [1742160900000, 0.29], [1742161200000, 0.32], [1742161500000, 0.29], [1742161800000, 0.32], [1742162100000, 0.27], [1742162400000, 0.29], [1742162700000, 0.33], [1742163000000, 0.3], [1742163300000, 0.31], [1742163600000, 0.35], [1742163900000, 0.3], [1742164200000, 0.29], [1742164500000, 0.31], [1742164800000, 0.29], [1742165100000, 0.28], [1742165400000, 0.37], [1742165700000, 0.33], [1742166000000, 0.41], [1742166300000, 0.29], [1742166600000, 0.34], [1742166900000, 0.31], [1742167200000, 0.39], [1742167500000, 0.39], [1742167800000, 0.36], [1742168100000, 0.34], [1742168400000, 0.31], [1742168700000, 0.35], [1742169000000, 0.32], [1742169300000, 0.36], [1742169600000, 0.41], [1742169900000, 0.35], [1742170200000, 0.32], [1742170500000, 0.42], [1742170800000, 0.36], [1742171100000, 0.36], [1742171400000, 0.39], [1742171700000, 0.38], [1742172000000, 0.41], [1742172300000, 0.39], [1742172600000, 0.38], [1742172900000, 0.33], [1742173200000, 0.42], [1742173500000, 0.42], [1742173800000, 0.38], [1742174100000, 1.3], [1742174400000, 1.43], [1742174700000, 0.43], [1742175000000, 0.41], [1742175300000, 0.4], [1742175600000, 0.33], [1742175900000, 0.46], [1742176200000, 0.35], [1742176500000, 0.41], [1742176800000, 0.36], [1742177100000, 0.38], [1742177400000, 0.39], [1742177700000, 1.22], [1742178000000, 2.0], [1742178300000, 0.39], [1742178600000, 0.39], [1742178900000, 0.36], [1742179200000, 0.37], [1742179500000, 0.38], [1742179800000, 0.42], [1742180100000, 0.39], [1742180400000, 0.35], [1742180700000, 0.38], [1742181000000, 0.34], [1742181300000, 1.31], [1742181600000, 2.06], [1742181900000, 0.4], [1742182200000, 0.39], [1742182500000, 0.39], [1742182800000, 0.38], [1742183100000, 0.36], [1742183400000, 0.4], [1742183700000, 0.36], [1742184000000, 0.39], [1742184300000, 0.34], [1742184600000, 2.0], [1742184900000, 1.18], [1742185200000, 2.11], [1742185500000, 0.33], [1742185800000, 0.55], [1742186100000, 0.36], [1742186400000, 0.31], [1742186700000, 0.36], [1742187000000, 0.38], [1742187300000, 0.37], [1742187600000, 0.41], [1742187900000, 0.37], [1742188200000, 0.32], [1742188500000, 0.88], [1742188800000, 1.97], [1742189100000, 0.35], [1742189400000, 0.41], [1742189700000, 0.39], [1742190000000, 0.38], [1742190300000, 0.37], [1742190600000, 0.4], [1742190900000, 0.34], [1742191200000, 0.4], [1742191500000, 0.35], [1742191800000, 0.37], [1742192100000, 0.99], [1742192400000, 2.06], [1742192700000, 0.47], [1742193000000, 0.35], [1742193300000, 0.37], [1742193600000, 0.36], [1742193900000, 0.39], [1742194200000, 0.33], [1742194500000, 0.36], [1742194800000, 0.4], [1742195100000, 0.32], [1742195400000, 0.43], [1742195700000, 1.21], [1742196000000, 2.02], [1742196300000, 0.41], [1742196600000, 0.43], [1742196900000, 0.42], [1742197200000, 0.41], [1742197500000, 0.36], [1742197800000, 0.33], [1742198100000, 0.38], [1742198400000, 0.35], [1742198700000, 0.43], [1742199000000, 0.36], [1742199300000, 1.28], [1742199600000, 1.97], [1742199900000, 0.48], [1742200200000, 0.34], [1742200500000, 0.37], [1742200800000, 0.45], [1742201100000, 0.35], [1742201400000, 0.36], [1742201700000, 0.36], [1742202000000, 0.41], [1742202300000, 0.36], [1742202600000, 0.39], [1742202900000, 1.23], [1742203200000, 2.02], [1742203500000, 0.35], [1742203800000, 0.33], [1742204100000, 1.22], [1742204400000, 0.34], [1742204700000, 0.32], [1742205000000, 0.3], [1742205300000, 0.35], [1742205600000, 0.37], [1742205900000, 0.33], [1742206200000, 0.3], [1742206500000, 1.2], [1742206800000, 1.95], [1742207100000, 0.29], [1742207400000, 0.38], [1742207700000, 0.29], [1742208000000, 0.33], [1742208300000, 0.3], [1742208600000, 0.32], [1742208900000, 0.31], [1742209200000, 0.36], [1742209500000, 0.33], [1742209800000, 0.31], [1742210100000, 0.69], [1742210400000, 2.04], [1742210700000, 0.34], [1742211000000, 0.31], [1742211300000, 0.34], [1742211600000, 0.3], [1742211900000, 0.34], [1742212200000, 0.34], [1742212500000, 0.31], [1742212800000, 0.33], [1742213100000, 0.36], [1742213400000, 0.35], [1742213700000, 0.7], [1742214000000, 2.1], [1742214300000, 0.32], [1742214600000, 0.36], [1742214900000, 0.32], [1742215200000, 0.33], [1742215500000, 0.33], [1742215800000, 0.3], [1742216100000, 0.33], [1742216400000, 0.38], [1742216700000, 0.35], [1742217000000, 0.3], [1742217300000, 0.74], [1742217600000, 2.1], [1742217900000, 0.36], [1742218200000, 0.33], [1742218500000, 0.31], [1742218800000, 0.32], [1742219100000, 0.39], [1742219400000, 0.36], [1742219700000, 0.32], [1742220000000, 0.34], [1742220300000, 0.33], [1742220600000, 0.36], [1742220900000, 0.5], [1742221200000, 2.09], [1742221500000, 0.36], [1742221800000, 0.32], [1742222100000, 0.33], [1742222400000, 0.28], [1742222700000, 0.34], [1742223000000, 0.3], [1742223300000, 0.36], [1742223600000, 0.35], [1742223900000, 0.34], [1742224200000, 0.32], [1742224500000, 0.43], [1742224800000, 1.96], [1742225100000, 0.36], [1742225400000, 0.35], [1742225700000, 0.32], [1742226000000, 0.32], [1742226300000, 0.31], [1742226600000, 0.34], [1742226900000, 0.33]], "symbolSize": 0, "lineStyle": {"width": 2}, "itemStyle": {"color": "#5470C6"}, "markPoint": {"data": [{"coord": [1742178000000, 2.0], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#1"}, "id": "anomaly-1"}, {"coord": [1742181600000, 2.06], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#2"}, "id": "anomaly-2"}, {"coord": [1742184600000, 2.0], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#3"}, "id": "anomaly-3"}, {"coord": [1742185200000, 2.11], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#4"}, "id": "anomaly-4"}, {"coord": [1742188800000, 1.97], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#5"}, "id": "anomaly-5"}, {"coord": [1742192400000, 2.06], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#6"}, "id": "anomaly-6"}, {"coord": [1742196000000, 2.02], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#7"}, "id": "anomaly-7"}, {"coord": [1742199600000, 1.97], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#8"}, "id": "anomaly-8"}, {"coord": [1742203200000, 2.02], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#9"}, "id": "anomaly-9"}, {"coord": [1742206800000, 1.95], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#10"}, "id": "anomaly-10"}, {"coord": [1742210400000, 2.04], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#11"}, "id": "anomaly-11"}, {"coord": [1742214000000, 2.1], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#12"}, "id": "anomaly-12"}, {"coord": [1742217600000, 2.1], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#13"}, "id": "anomaly-13"}, {"coord": [1742221200000, 2.09], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#14"}, "id": "anomaly-14"}, {"coord": [1742224800000, 1.96], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#15"}, "id": "anomaly-15"}, {"coord": [1742214000000, 2.1], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#17"}, "id": "anomaly-17"}, {"coord": [1742181600000, 2.06], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#18"}, "id": "anomaly-18"}, {"coord": [1742181300000, 1.31], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#19"}, "id": "anomaly-19"}, {"coord": [1742221200000, 2.09], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#20"}, "id": "anomaly-20"}, {"coord": [1742210400000, 2.04], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#21"}, "id": "anomaly-21"}, {"coord": [1742192400000, 2.06], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#22"}, "id": "anomaly-22"}, {"coord": [1742206800000, 1.95], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#23"}, "id": "anomaly-23"}, {"coord": [1742224800000, 1.96], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#24"}, "id": "anomaly-24"}, {"coord": [1742184600000, 2.0], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#25"}, "id": "anomaly-25"}, {"coord": [1742199600000, 1.97], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#26"}, "id": "anomaly-26"}, {"coord": [1742178000000, 2.0], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#27"}, "id": "anomaly-27"}, {"coord": [1742188800000, 1.97], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#28"}, "id": "anomaly-28"}, {"coord": [1742217600000, 2.1], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#29"}, "id": "anomaly-29"}, {"coord": [1742185200000, 2.11], "symbol": "circle", "symbolSize": 10, "itemStyle": {"color": "red"}, "label": {"show": true, "position": "top", "formatter": "#30"}, "id": "anomaly-30"}], "symbolSize": 8, "emphasis": {"scale": true, "itemStyle": {"shadowBlur": 10, "shadowColor": "rgba(0, 0, 0, 0.5)"}}, "tooltip": {"formatter": "{@id}"}}, "markArea": {"data": [[{"xAxis": 1742185200000, "itemStyle": {"color": "rgba(255, 100, 100, 0.2)"}, "id": "anomaly-16"}, {"xAxis": 1742185500000}]], "emphasis": {"itemStyle": {"opacity": 0.8}}}}, {"name": "CUSUM 辅助曲线", "type": "line", "yAxisIndex": 1, "data": [[1742140800000, 0.0], [1742141100000, 0.0], [1742141400000, 0.0], [1742141700000, 0.0], [1742142000000, 0.0], [1742142300000, 0.0], [1742142600000, 0.0], [1742142900000, 0.0], [1742143200000, 0.0], [1742143500000, 0.0], [1742143800000, 0.0], [1742144100000, 0.0], [1742144400000, 0.0], [1742144700000, 0.0], [1742145000000, 0.0], [1742145300000, 1.2571181134587148], [1742145600000, 0.22337227121203695], [1742145900000, 0.0], [1742146200000, 0.0], [1742146500000, 0.0], [1742146800000, 0.0], [1742147100000, 0.0], [1742147400000, 0.0], [1742147700000, 0.0], [1742148000000, 0.0], [1742148300000, 0.0], [1742148600000, 0.0], [1742148900000, 0.0], [1742149200000, 0.0], [1742149500000, 0.0], [1742149800000, 0.0], [1742150100000, 0.0], [1742150400000, 0.0], [1742150700000, 0.0], [1742151000000, 0.0], [1742151300000, 0.0], [1742151600000, 0.0], [1742151900000, 0.0], [1742152200000, 0.0], [1742152500000, 0.0], [1742152800000, 0.0], [1742153100000, 0.0], [1742153400000, 0.0], [1742153700000, 0.0], [1742154000000, 0.0], [1742154300000, 0.0], [1742154600000, 0.0], [1742154900000, 0.0], [1742155200000, 0.0], [1742155500000, 0.0], [1742155800000, 0.0], [1742156100000, 0.0], [1742156400000, 0.0], [1742156700000, 0.0], [1742157000000, 0.0], [1742157300000, 0.0], [1742157600000, 0.0], [1742157900000, 0.0], [1742158200000, 0.0], [1742158500000, 0.0], [1742158800000, 0.0], [1742159100000, 0.0], [1742159400000, 0.0], [1742159700000, 0.0], [1742160000000, 0.0], [1742160300000, 0.0], [1742160600000, 0.0], [1742160900000, 0.0], [1742161200000, 0.0], [1742161500000, 0.0], [1742161800000, 0.0], [1742162100000, 0.0], [1742162400000, 0.0], [1742162700000, 0.0], [1742163000000, 0.0], [1742163300000, 0.0], [1742163600000, 0.0], [1742163900000, 0.0], [1742164200000, 0.0], [1742164500000, 0.0], [1742164800000, 0.0], [1742165100000, 0.0], [1742165400000, 0.0], [1742165700000, 0.0], [1742166000000, 0.0], [1742166300000, 0.0], [1742166600000, 0.0], [1742166900000, 0.0], [1742167200000, 0.0], [1742167500000, 0.0], [1742167800000, 0.0], [1742168100000, 0.0], [1742168400000, 0.0], [1742168700000, 0.0], [1742169000000, 0.0], [1742169300000, 0.0], [1742169600000, 0.0], [1742169900000, 0.0], [1742170200000, 0.0], [1742170500000, 0.0], [1742170800000, 0.0], [1742171100000, 0.0], [1742171400000, 0.0], [1742171700000, 0.0], [1742172000000, 0.0], [1742172300000, 0.0], [1742172600000, 0.0], [1742172900000, 0.0], [1742173200000, 0.0], [1742173500000, 0.0], [1742173800000, 0.0], [1742174100000, 1.3058598997503188], [1742174400000, 2.928541410396064], [1742174700000, 2.1141336064616043], [1742175000000, 1.2509840162355408], [1742175300000, 0.3634635328636753], [1742175600000, 0.0], [1742175900000, 0.0], [1742176200000, 0.0], [1742176500000, 0.0], [1742176800000, 0.0], [1742177100000, 0.0], [1742177400000, 0.0], [1742177700000, 1.1108927545839025], [1742178000000, 4.122715174540365], [1742178300000, 3.2108237980226972], [1742178600000, 2.2989324215050297], [1742178900000, 1.313928365549956], [1742179200000, 0.3532952027406844], [1742179500000, 0.0], [1742179800000, 0.0], [1742180100000, 0.0], [1742180400000, 0.0], [1742180700000, 0.0], [1742181000000, 0.0], [1742181300000, 1.3302307928961212], [1742181600000, 4.488278571727395], [1742181900000, 3.60075808835553], [1742182200000, 2.6888667118378624], [1742182500000, 1.7769753353201947], [1742182800000, 0.840713065656725], [1742183100000, 0.0], [1742183400000, 0.0], [1742183700000, 0.0], [1742184000000, 0.0], [1742184300000, 0.0], [1742184600000, 3.011822419956462], [1742184900000, 4.025231601957156], [1742185200000, 7.30513384651744], [1742185500000, 6.2470171111249595], [1742185800000, 5.725060024940125], [1742186100000, 4.74005596898505], [1742186400000, 3.633197447300966], [1742186700000, 2.6481933913458926], [1742187000000, 1.711931121682423], [1742187300000, 0.7512979588731512], [1742187600000, 0.0], [1742187900000, 0.0], [1742188200000, 0.0], [1742188500000, 0.2822823876266328], [1742188800000, 3.2209921281456895], [1742189100000, 2.211617179044813], [1742189400000, 1.3484675888187494], [1742189700000, 0.4365762123010817], [1742190000000, 0.0], [1742190300000, 0.0], [1742190600000, 0.0], [1742190900000, 0.0], [1742191200000, 0.0], [1742191500000, 0.0], [1742191800000, 0.0], [1742192100000, 0.5503622122304552], [1742192400000, 3.708409991061729], [1742192700000, 2.9914857597104776], [1742193000000, 1.9821108106096015], [1742193300000, 1.0214776478003298], [1742193600000, 0.03647359184525589], [1742193900000, 0.0], [1742194200000, 0.0], [1742194500000, 0.0], [1742194800000, 0.0], [1742195100000, 0.0], [1742195400000, 0.0], [1742195700000, 1.0865218614381003], [1742196000000, 4.147086067686167], [1742196300000, 3.283936477460103], [1742196600000, 2.4695286735256436], [1742196900000, 1.6307499764453823], [1742197200000, 0.7676003862193188], [1742197500000, 0.0], [1742197800000, 0.0], [1742198100000, 0.0], [1742198400000, 0.0], [1742198700000, 0.0], [1742199000000, 0.0], [1742199300000, 1.2571181134587148], [1742199600000, 4.195827853977771], [1742199900000, 3.503274515772321], [1742200200000, 2.4695286735256428], [1742200500000, 1.508895510716371], [1742200800000, 0.7432294930735157], [1742201100000, 0.0], [1742201400000, 0.0], [1742201700000, 0.0], [1742202000000, 0.0], [1742202300000, 0.0], [1742202600000, 0.0], [1742202900000, 1.1352636477297045], [1742203200000, 4.195827853977771], [1742203500000, 3.1864529048768944], [1742203800000, 2.128336169484414], [1742204100000, 3.2392289240683168], [1742204400000, 2.2054830818216384], [1742204700000, 1.1229954532833564], [1742205000000, 0.0], [1742205300000, 0.0], [1742205600000, 0.0], [1742205900000, 0.0], [1742206200000, 0.0], [1742206500000, 1.0621509682922983], [1742206800000, 3.95211892251975], [1742207100000, 2.7965186145440617], [1742207400000, 1.860256344880592], [1742207700000, 0.7046560369049037], [1742208000000, 0.0], [1742208300000, 0.0], [1742208600000, 0.0], [1742208900000, 0.0], [1742209200000, 0.0], [1742209500000, 0.0], [1742209800000, 0.0], [1742210100000, 0.0], [1742210400000, 3.109305992539671], [1742210700000, 2.0755601502929926], [1742211000000, 0.9687016286089085], [1742211300000, 0.0], [1742211600000, 0.0], [1742211900000, 0.0], [1742212200000, 0.0], [1742212500000, 0.0], [1742212800000, 0.0], [1742213100000, 0.0], [1742213400000, 0.0], [1742213700000, 0.0], [1742214000000, 3.255531351414483], [1742214300000, 2.1730437228762005], [1742214600000, 1.1880396669211266], [1742214900000, 0.10555203838284455], [1742215200000, 0.0], [1742215500000, 0.0], [1742215800000, 0.0], [1742216100000, 0.0], [1742216400000, 0.0], [1742216700000, 0.0], [1742217000000, 0.0], [1742217300000, 0.0], [1742217600000, 3.255531351414483], [1742217900000, 2.2705272954594093], [1742218200000, 1.2124105600669295], [1742218500000, 0.10555203838284544], [1742218800000, 0.0], [1742219100000, 0.0], [1742219400000, 0.0], [1742219700000, 0.0], [1742220000000, 0.0], [1742220300000, 0.0], [1742220600000, 0.0], [1742220900000, 0.0], [1742221200000, 3.231160458268681], [1742221500000, 2.2461564023136074], [1742221800000, 1.1636687737753253], [1742222100000, 0.10555203838284544], [1742222400000, 0.0], [1742222700000, 0.0], [1742223000000, 0.0], [1742223300000, 0.0], [1742223600000, 0.0], [1742223900000, 0.0], [1742224200000, 0.0], [1742224500000, 0.0], [1742224800000, 2.914338847373254], [1742225100000, 1.9293347914181804], [1742225400000, 0.9199598423173045], [1742225700000, 0.0], [1742226000000, 0.0], [1742226300000, 0.0], [1742226600000, 0.0], [1742226900000, 0.0]], "lineStyle": {"type": "dashed", "width": 1.5}, "itemStyle": {"color": "#EE6666"}, "showSymbol": false}], "dataZoom": [{"type": "slider", "show": true, "xAxisIndex": [0], "start": 0, "end": 100, "bottom": 5}, {"type": "inside", "xAxisIndex": [0], "start": 0, "end": 100}]};
        
        // 设置自定义tooltip格式化器
        option.tooltip.formatter = customTooltipFormatter;
        
        chart.setOption(option);
        
        // 处理窗口大小变化
        window.addEventListener('resize', function() {
            chart.resize();
        });
    </script>
</body>
</html>